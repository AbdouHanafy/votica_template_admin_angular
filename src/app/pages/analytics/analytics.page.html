<section class="analytics-page">
  <header class="analytics-page__hero">
    <h1>{{ language.t('analytics.title') }}</h1>
    <p>{{ language.t('analytics.subtitle') }}</p>
  </header>

  <div class="kpi-grid">
    @for (kpi of data.kpiWidgets; track kpi.label) {
      <app-card [padded]="false">
        <div class="kpi-item">
          <p>{{ kpi.label }}</p>
          <strong>{{ kpi.value }}</strong>
          <span>{{ kpi.delta }}</span>
        </div>
      </app-card>
    }
  </div>

  <div class="analytics-grid">
    <app-card [title]="language.t('analytics.trafficPerformance')" [subtitle]="language.t('analytics.sessionsConversions')">
      <app-chart
        [series]="areaSeries"
        [chart]="{ type: 'area', height: 300, toolbar: { show: false } }"
        [stroke]="{ curve: 'smooth', width: 2.5 }"
        [fill]="{ type: 'gradient', gradient: { shadeIntensity: 1, opacityFrom: 0.3, opacityTo: 0.05 } }"
        [colors]="['#2563eb', '#14b8a6']"
        [xaxis]="{ categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'] }"
        [dataLabels]="{ enabled: false }"
      />
    </app-card>

    <app-card [title]="language.t('analytics.performanceScorecard')" [subtitle]="language.t('analytics.coreHealth')">
      <div class="metric-list">
        @for (metric of data.performanceMetrics; track metric.label) {
          <article class="metric-item">
            <div class="metric-item__row">
              <span>{{ metric.label }}</span>
              <strong>{{ metric.value }}</strong>
            </div>
            <div class="metric-progress">
              <span [style.width.%]="metric.progress"></span>
            </div>
          </article>
        }
      </div>
    </app-card>

    <app-card [title]="language.t('analytics.trafficStats')" [subtitle]="language.t('analytics.sourceContribution')">
      <div class="traffic-list">
        @for (source of data.trafficSources; track source.label) {
          <article class="traffic-item">
            <div class="traffic-item__head">
              <span>{{ sourceLabel(source.label) }}</span>
              <strong>{{ source.value }}%</strong>
            </div>
            <div class="traffic-item__progress">
              <span [style.width.%]="source.value"></span>
            </div>
          </article>
        }
      </div>
    </app-card>

    <app-card [title]="language.t('analytics.monthlyComparison')" [subtitle]="language.t('analytics.yearComparison')">
      <div class="comparison">
        <app-chart
          [series]="comparisonCurrentSeries"
          [chart]="{ type: 'bar', height: 250, toolbar: { show: false } }"
          [colors]="['#2563eb']"
          [plotOptions]="{ bar: { columnWidth: '48%', borderRadius: 6 } }"
          [xaxis]="{ categories: comparisonCategories }"
          [dataLabels]="{ enabled: false }"
        />
        <app-chart
          [series]="comparisonPreviousSeries"
          [chart]="{ type: 'bar', height: 250, toolbar: { show: false } }"
          [colors]="['#94a3b8']"
          [plotOptions]="{ bar: { columnWidth: '48%', borderRadius: 6 } }"
          [xaxis]="{ categories: comparisonCategories }"
          [dataLabels]="{ enabled: false }"
        />
      </div>
    </app-card>
  </div>
</section>
